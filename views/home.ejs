<!DOCTYPE html>
<html>

<head>
    <title>CSV DATA</title>
    <link rel='stylesheet' type='text/css' href='/css/home.css'>
</head>

<body>
    <div class="mainDiv">
        <div class="mainHeader">
            <form method="POST" action="/file/upload" enctype="multipart/form-data">
                <input type="file" name="csvFile" accept=".csv" required />
                <button type="Submit">Upload</button>
            </form>
            <a href="/" type="button" class="btnList" style="text-decoration: none;">Show All Files</a>
        </div>

        <% if(locals.error){ %>
        <div class="error">
            <span><%= locals.error %></span>
        </div>
        <% } %>

        <% if(locals.fileLists){ %>
        <div class="listOfFiles">
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>uploaded At</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                <% for(var i=0; i<locals.fileLists.length; i++){ %>
                    <tr>
                        <td><%= fileLists[i].originalFileName %></td>
                        <td><%= fileLists[i].createdAt.toLocaleString() %></td>
                        <td><a href="/file/<%= fileLists[i]._id %>"  type="button" class="btnList" style="text-decoration: none;">Get Details</a></td>
                    </tr>
                <% } %>
                </tbody>
            </table>
        </div>
        <% } %>

        <% if(locals.fileDetails){ %>
        <div class="fileDetails">
            <div class="filter">
                <input type="text" placeholder="Search..." onkeyup="search(event)" />
            </div>
            <table>
                <thead>
                    <tr>
                        <% for(var i=0; i<locals.fileDetails.keys.length; i++){ %>
                        <th><%= fileDetails.keys[i] %></th>
                        <% } %>
                    </tr>
                </thead>
                <tbody>
                <% for(var i=0; i<locals.fileDetails.content.length; i++){ %>
                    <tr>
                        <% for(var j=0; j<locals.fileDetails.keys.length; j++){ %>
                        <td><%= fileDetails.content[i][fileDetails.keys[j]] %></td>
                        <% } %>
                    </tr>
                <% } %>
                </tbody>
            </table>
        </div>
        <% } %>
    </div>
    <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
    <script src="/js/script.js"></script>
</body>

</html>